{% extends "base.html" %}

{% block title %}Import Trips ‚Äì TripPlanner{% endblock %}

{% block extra_head %}
<style>
/* ============= COLOR VARIABLES ============= */
:root {
  --background: #faf9f7;
  --foreground: #1a1a1a;
  --card: #f5f3ef;
  --border: rgba(0, 0, 0, 0.08);
  --olive-green: #6b7455;
  --olive-green-light: #8b9474;
  --olive-green-subtle: #a8b193;
  --beige-card: #f5f3ef;
  --off-white: #faf9f7;
  --warm-gray: #8a8884;
  --destructive: #d4183d;
}

.dashboard-page {
  background: linear-gradient(135deg, var(--off-white) 0%, var(--beige-card) 100%);
  min-height: 100vh;
}

.import-form {
  background: linear-gradient(135deg, var(--card) 0%, var(--off-white) 100%);
  border: 1px solid var(--olive-green-subtle);
  box-shadow: 0 2px 8px rgba(107, 116, 85, 0.1);
}

.import-form input[type="file"] {
  border: 2px dashed var(--olive-green-subtle);
  background: var(--card);
}

.import-form input[type="file"]:hover {
  border-color: var(--olive-green);
}

.btn-primary {
  background: var(--olive-green);
  border-color: var(--olive-green);
}

.btn-primary:hover {
  background: var(--olive-green-light);
}
</style>
{% endblock %}

{% block content %}

<div class="dashboard-page">
    <div class="dashboard-container">

        <!-- Breadcrumb -->
        <div class="breadcrumb">
            <span class="breadcrumb-icon">üè†</span>
            <a href="/dashboard" class="breadcrumb-link">Dashboard</a>
            <span class="breadcrumb-sep">‚Üí</span>
            <span class="breadcrumb-current">Import Trip</span>
        </div>

        <header class="dashboard-header">
            <h1>Import Trip</h1>
            <p class="sub">Upload itinerary CSV or JSON file</p>
        </header>

        <section class="import-card">
            <form action="/import-trip" method="POST" enctype="multipart/form-data" class="import-form">
                <input type="file" name="trip_file" accept=".csv,.json" required>
                <button type="submit" class="btn primary">Import Trip</button>
            </form>
        </section>

        <!-- Help Section -->
        <section class="profile-card">
            <h3>How to Import</h3>
            <p class="sub">Upload either a CSV or JSON file with your trip data.</p>
            
            <h4 style="margin-top: var(--space-lg); margin-bottom: var(--space-md);">üìÑ CSV Format</h4>
            <p style="margin-bottom: var(--space-sm);">Required columns:</p>
            <ul style="margin: var(--space-md) 0; padding-left: var(--space-lg); line-height: 1.8;">
                <li><strong>trip_name</strong> ‚Äì Name of your trip (same for all rows)</li>
                <li><strong>trip_start</strong> ‚Äì Start date (YYYY-MM-DD, same for all rows)</li>
                <li><strong>trip_end</strong> ‚Äì End date (YYYY-MM-DD, same for all rows)</li>
                <li><strong>day_date</strong> ‚Äì Date of the day (YYYY-MM-DD)</li>
                <li><strong>time</strong> ‚Äì Task time (HH:MM, 24-hour format)</li>
                <li><strong>title</strong> ‚Äì Task title</li>
                <li><strong>description</strong> ‚Äì Task description (optional)</li>
                <li><strong>lat</strong> ‚Äì Latitude (optional)</li>
                <li><strong>lng</strong> ‚Äì Longitude (optional)</li>
            </ul>
            
            <h5 style="margin-top: var(--space-md);">CSV Example:</h5>
            <pre style="background: var(--color-bg-muted); padding: var(--space-md); border-radius: var(--radius-md); overflow-x: auto; margin-top: var(--space-sm); font-size: 0.85em;">
trip_name,trip_start,trip_end,day_date,time,title,description,lat,lng
"Trip to Paris",2026-03-15,2026-03-20,2026-03-15,08:00,Flight to Paris,Depart from JFK,48.8566,2.3522
"Trip to Paris",2026-03-15,2026-03-20,2026-03-15,14:00,Check-in Hotel,Hotel near Eiffel Tower,48.8584,2.2945
"Trip to Paris",2026-03-15,2026-03-20,2026-03-16,09:00,Visit Louvre,Morning museum tour,48.8606,2.3376
            </pre>
            
            <h4 style="margin-top: var(--space-lg); margin-bottom: var(--space-md);">üìã JSON Format</h4>
            <h5 style="margin-bottom: var(--space-sm);">JSON Example:</h5>
            <pre style="background: var(--color-bg-muted); padding: var(--space-md); border-radius: var(--radius-md); overflow-x: auto; margin-top: var(--space-sm); font-size: 0.85em;">
{
  "trip_name": "Trip to Paris",
  "start_date": "2026-03-15",
  "end_date": "2026-03-20",
  "days": [
    {
      "date": "2026-03-15",
      "tasks": [
        {
          "title": "Flight to Paris",
          "start_time": "08:00",
          "end_time": "12:00",
          "description": "Depart from JFK",
          "lat": 48.8566,
          "lng": 2.3522
        },
        {
          "title": "Check-in Hotel",
          "start_time": "14:00",
          "end_time": "15:00",
          "description": "Hotel near Eiffel Tower"
        }
      ]
    },
    {
      "date": "2026-03-16",
      "tasks": [
        {
          "title": "Visit Louvre",
          "start_time": "09:00",
          "end_time": "12:00",
          "description": "Morning museum tour"
        }
      ]
    }
  ]
}
            </pre>
            
            <div style="margin-top: var(--space-lg); padding: var(--space-md); background: var(--color-warning-bg, #fff3cd); border-radius: var(--radius-md); border-left: 3px solid var(--color-warning, #ffc107);">
                <strong>üí° Tips:</strong>
                <ul style="margin: var(--space-sm) 0 0; padding-left: var(--space-lg); line-height: 1.6;">
                    <li>One trip per file</li>
                    <li>Tasks are automatically sorted by time within each day</li>
                    <li>Empty rows are ignored (CSV only)</li>
                    <li>All dates must be in YYYY-MM-DD format</li>
                    <li>All times must be in HH:MM (24-hour) format</li>
                    <li>Put commas in CSV text fields inside quotes: "Text, with commas"</li>
                </ul>
            </div>
        </section>

    </div>
</div>
{% endblock %}